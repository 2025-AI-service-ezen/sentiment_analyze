## 감성 분석 앙상블 모델 프로젝트 구조 및 목표 요구사항

**문서 버전:** 2.0
**작성일:** 2025년 7월 18일

### 1. 프로젝트 개요

본 프로젝트는 숙박업소 리뷰 데이터를 바탕으로 감성 분석 모델을 구축하는 것을 목표로 하며, 4개의 이종(heterogeneous) 감성 분석 모델(BERT, BiLSTM, LSTM, Word Sentiment)을 개발하고, 이를 앙상블하여 높은 정확도의 감성 분석 API 서비스를 제공하는 것을 목표로 한다. 특히, 초기 데이터셋이 가진 라벨링 오류 및 편향 가능성을 인지하고, 학습된 모델을 활용하여 데이터셋을 점진적으로 정제하고 모델 성능을 향상시키는 자기지도학습(Self-training) 기반의 MLOps 파이프라인 구축을 핵심 과제로 삼는다.

프로젝트의 복잡성을 관리하고 개발 효율성을 높이기 위해, 전체 시스템을 아래와 같이 3개의 독립적이면서도 유기적으로 연동되는 하위 프로젝트로 재구성한다.

1.  **감성 분석 모델 구현 및 학습**
2.  **점진적 자기지도학습 기반 데이터셋 정제 및 모델 재훈련**
3.  **앙상블 모델 기반 감성 분석 API 서비스**

---

### 2. 전체 프로젝트 목표 및 핵심 요구사항

#### 2.1. 목표

*   **최고 수준의 감성 분석 정확도 달성:** 4개 모델의 강점을 결합한 앙상블 기법을 통해 단일 모델의 한계를 뛰어넘는 90% 이상의 감성 분석 정확도를 목표로 한다. **감성 분류는 초기 학습 시 평점 1과 5의 데이터(각 라벨당 최대 1만개)를 활용하여 이진 분류 모델을 학습하며, 이후 학습된 초기 모델을 통해 2, 3, 4를 포함한 모든 임시 라벨 데이터를 정제하고, 0.0~0.3은 부정, 0.3 초과~0.7 미만은 중립/복합, 0.7 이상은 긍정으로 분류한다. 이후 자기지도학습을 통해 점진적으로 라벨을 정제하고 모델 성능을 향상시킨다.**
*   **지속 가능한 모델 성능 향상 파이프라인 구축:** 데이터 정제와 모델 재훈련이 선순환 구조로 자동화된 MLOps 파이프라인을 구축하여, 시간이 지남에 따라 모델이 스스로 성능을 개선할 수 있도록 한다.
*   **안정적이고 확장 가능한 API 서비스 제공:** 개발된 모델을 안정적으로 서빙하고, 증가하는 요청에 유연하게 대응할 수 있는 확장 가능한 API 서비스를 구축한다.

#### 2.2. 핵심 요구사항

*   **데이터 요구사항:**
    *   숙박업소 리뷰 데이터(y_review.csv, naver_shopping.txt 등)를 통합하고, 문장 단위로 분리하여 SQLite 데이터베이스에서 체계적으로 관리해야 한다.
    *   초기 학습을 위해 클래스 불균형을 해소한 2만개 규모의 균형 데이터셋을 구축하고, 이 데이터셋은 DVC를 통해 버전을 관리하여 실험의 재현성을 보장해야 한다.
    *   숙박업소 도메인에 특화된 감성 사전 구축 및 지속적인 업데이트를 지원해야 한다.
*   **모델 요구사항:**
    *   BERT, BiLSTM, LSTM, Word Sentiment 모델을 각각 독립적으로 구현하고 학습할 수 있어야 한다.
    *   각 모델의 학습 과정, 하이퍼파라미터, 성능 지표는 MLflow를 통해 체계적으로 추적 및 관리되어야 한다.
    *   학습된 모델 아티팩트(모델 파일, **각 모델에 특화된 토크나이저**)는 버전 관리되어야 한다.
*   **재훈련 요구사항:**
    *   초기 학습된 앙상블 모델을 사용하여 데이터셋의 임시 라벨을 검증하고, 신뢰도가 낮은 라벨을 식별할 수 있어야 한다.
    *   모델별 특성을 고려한 차별화된 재훈련 전략(예: BERT-파인튜닝, BiLSTM-부분 재훈련)을 적용할 수 있어야 한다.
    *   데이터 정제 및 재훈련의 전 과정은 자동화되어야 하며, 각 사이클별 성능 변화를 추적할 수 있어야 한다.
    *   **Gemini API (gemini-2.5-flash)를 활용하여 저신뢰도 샘플 재라벨링, 앙상블 모델의 정성적 평가, 데이터셋/모델 편향 감지 및 완화에 최소한으로 도입하며, 비용 효율적인 사용을 위해 호출 제한 및 토큰 제한을 최대한 활용해야 한다.**
*   **API 서비스 요구사항:**
    *   FastAPI를 사용하여 비동기 처리가 가능한 RESTful API를 구축해야 한다.
    *   프로젝트 2에서 제공하는 최신 앙상블 모델을 자동으로 로드하고 활용해야 한다.
    *   API 요청 수, 응답 시간, 예측 결과 분포 등 주요 지표를 Prometheus와 Grafana를 통해 실시간으로 모니터링할 수 있어야 한다.
    *   Docker를 사용하여 API 서비스를 컨테이너화하여 배포 일관성을 확보해야 한다.
    *   **프로젝트 2에서 업데이트된 모델을 자동으로 감지하고 로드하는 메커니즘을 구현해야 한다.**

---

### 3. 하위 프로젝트별 상세 정의

#### 3.1. 프로젝트 1: 감성 분석 모델 구현 및 학습

*   **목표:** 4개의 개별 감성 분석 모델을 독립적으로 구현하고, 원본 데이터의 문제를 해결하기 위해 구축된 **체계적인 데이터 파이프라인**을 통해 생성된 **균형 잡힌 초기 데이터셋**으로 학습을 완료하여 각 모델의 베이스라인 성능을 확보한다.
*   **주요 기능:**
    *   SQLite와 KSS를 활용한 데이터 통합 및 문장 분리 파이프라인 구축
    *   언더샘플링을 통한 초기 학습 데이터셋(200k) 생성 및 DVC 버전 관리
    *   BERT, BiLSTM, LSTM, Word Sentiment 모델 학습 및 평가 파이프라인 구축
    *   MLflow를 이용한 실험 관리 및 모델/토크나이저 아티팩트 버전 관리
*   **입력:** 원시 데이터 파일 (`y_reviews.csv`, `naver_shopping.txt`)
*   **출력:**
    *   SQLite 데이터베이스 (`sentiment_analysis.db`)
    *   DVC로 버전 관리되는 학습 데이터셋 (`v1.0-balanced-200k.csv`)
    *   학습된 모델 파일 (BERT, BiLSTM, LSTM)
    *   감성 사전 (Word Sentiment)
    *   각 모델별 토크나이저
    *   각 모델의 베이스라인 성능 평가 보고서
*   **연관성:** 프로젝트 2와 3에 신뢰할 수 있는 초기 모델과 데이터 처리 기반을 제공하는 출발점 역할을 한다.

#### 3.2. 프로젝트 2: 점진적 자기지도학습 기반 데이터셋 정제 및 모델 재훈련

*   **목표:** 프로젝트 1에서 구축된 베이스라인 모델들을 활용하여 **전체 데이터셋**의 임시 라벨을 검증하고, 부정확한 라벨을 수정한다. 이렇게 정제된 고품질 데이터셋으로 모델을 반복적으로 재훈련하여 성능을 점진적으로 극대화하는 자기지도학습(Self-training) 루프를 구축한다.
*   **주요 기능:**
    *   앙상블 모델을 이용한 라벨 예측 및 불일치 데이터 탐지
    *   신뢰도 기반 라벨 수정 및 데이터셋 정제
    *   모델별 차별화된 재훈련 전략(파인튜닝, 부분 재훈련 등) 적용
    *   재훈련 과정 및 성능 변화 추적/기록 (SMOTE, 클래스 가중치 등 추가 기법 검토)
*   **입력:**
    *   SQLite DB에 저장된 전체 문장 데이터
    *   프로젝트 1에서 학습된 베이스라인 모델들
*   **출력:**
    *   라벨이 정제된 고품질 데이터셋
    *   성능이 향상된 최종 모델들
    *   데이터 정제 및 재훈련 과정에 대한 상세 로그 및 성능 리포트
*   **연관성:** 프로젝트 1의 모델을 입력으로 받아 성능을 개선하고, 프로젝트 3에 최종적으로 서빙될 모델을 제공하는 핵심 브릿지 역할을 한다.

#### 3.3. 프로젝트 3: 앙상블 모델 기반 감성 분석 API 서비스

*   **목표:** 프로젝트 2에서 점진적으로 완성되는 최신 앙상블 모델을 가져다가 외부에서 텍스트 감성 분석을 요청할 수 있는 안정적이고 확장 가능한 API 서비스를 제공한다. **자기지도학습이 진행되어 최신 앙상블 모델이 구축되면 자동으로 교체되어야 한다.**
*   **주요 기능:**
    *   FastAPI 기반 RESTful API 엔드포인트(`POST /predict`) 구현
    *   프로젝트 2에서 제공하는 최신 앙상블 모델 로드 및 활용
    *   API 요청/응답 데이터 유효성 검사
    *   Prometheus, Grafana를 이용한 실시간 API 모니터링 대시보드 구축
    *   Docker를 사용하여 API 서비스를 컨테이너화하여 배포 일관성 확보
    *   **프로젝트 2에서 업데이트된 모델을 자동으로 감지하고 로드하는 메커니즘 구현**
*   **입력:** 외부 사용자의 텍스트 분석 요청 (JSON 형식)
*   **출력:** 텍스트에 대한 감성 분석 결과 (긍정/부정, 신뢰도 점수 등)
*   **연관성:** 프로젝트 2에서 완성된 최종 모델들을 실제 서비스로 제공하는 최종 단계이며, 모델 업데이트의 자동화를 통해 지속적인 서비스 품질을 보장한다.